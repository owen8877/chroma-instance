from keras.engine.saving import load_model

colorizationModel = load_model('../../../weights/chroma_gan/imagenet.h5')

print(colorizationModel.summary())

'''
Model: "model_4"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0                                            
__________________________________________________________________________________________________
model_3 (Model)                 (None, 28, 28, 512)  7635264     input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 14, 14, 512)  2359808     model_3[1][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 14, 14, 512)  2359808     batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 512)  2048        conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 7, 7, 512)    2359808     batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 512)    2048        conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 7, 7, 512)    2359808     batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 512)    2048        conv2d_9[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 25088)        0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1024)         25691136    flatten_1[0][0]                  
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 28, 28, 512)  2359808     model_3[1][0]                    
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          524800      dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 28, 28, 512)  2048        conv2d_10[0][0]                  
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 28, 28, 256)  1179904     batch_normalization_5[0][0]      
__________________________________________________________________________________________________
repeat_vector_1 (RepeatVector)  (None, 784, 256)     0           dense_3[0][0]                    
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 28, 28, 256)  1024        conv2d_11[0][0]                  
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 28, 28, 256)  0           repeat_vector_1[0][0]            
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 28, 512)  0           batch_normalization_6[0][0]      
                                                                 reshape_1[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 28, 28, 256)  131328      concatenate_2[0][0]              
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 28, 28, 128)  295040      conv2d_12[0][0]                  
__________________________________________________________________________________________________
up_sampling2d_1 (UpSampling2D)  (None, 56, 56, 128)  0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 56, 56, 64)   73792       up_sampling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 56, 56, 64)   36928       conv2d_14[0][0]                  
__________________________________________________________________________________________________
up_sampling2d_2 (UpSampling2D)  (None, 112, 112, 64) 0           conv2d_15[0][0]                  
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 25088)        0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 112, 112, 32) 18464       up_sampling2d_2[0][0]            
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 4096)         102764544   flatten_2[0][0]                  
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 112, 112, 2)  578         conv2d_16[0][0]                  
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 4096)         16781312    dense_4[0][0]                    
__________________________________________________________________________________________________
up_sampling2d_3 (UpSampling2D)  (None, 224, 224, 2)  0           conv2d_17[0][0]                  
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1000)         4097000     dense_5[0][0]                    
==================================================================================================
'''
